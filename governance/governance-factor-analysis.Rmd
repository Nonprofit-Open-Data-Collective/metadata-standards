---
title: "Governance - Factor Analysis"
author: "Olivia Beck"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Data and Libraries

```{r, message= FALSE}
load("governance/governance.Rdata")

library(dplyr)
library(purrr)
library(tidyr)
library(kableExtra)
library(data.table)


```

## Making Design Matrix

1 is positive direction (i.e. good governance practices)

0 is negative direction (i.e. bad governance practices)

+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| Variable Name(s)       | Original Coding                             | Design Matrix Coding                                                       |
+========================+=============================================+============================================================================+
| P4_LINE_12A            | yes/no                                      | 1 - yes to either 12A or 12B                                               |
|                        |                                             |                                                                            |
| P4_LINE_12B            | yes/no                                      | 0 - no to both                                                             |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| P4_Line_28A, B, C      | yes/no                                      | 0 - no to all                                                              |
|                        |                                             |                                                                            |
|                        | yes/no                                      | 1 - yes to any of 28A, 28B, or 28C                                         |
|                        |                                             |                                                                            |
|                        | yes/no                                      |                                                                            |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| P4_Line_29             | yes/no                                      | 1 - (29 no) or (30 no) or (29 yes and PM 31 yes) or (30 yes and PM 31 yes) |
|                        |                                             |                                                                            |
| P4_Line_30             | yes/no                                      | 0 - (29 yes and PM 31 no) or (30 yes and PM 31 no)                         |
|                        |                                             |                                                                            |
| PM_LINE_31             | yes/no/na                                   |                                                                            |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| P6_LINE_1A, P6_LINE_1B | numeric                                     | is P6_LINE_1B / P6_LINE_1A \>= 0.75                                        |
|                        |                                             |                                                                            |
|                        |                                             | i.e. is the proportion of independent members at least 0.75?               |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| P6_LINE_2              | yes/no                                      | 0/1 (no is good)                                                           |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| P6_LINE_3              | yes/no                                      | 0/1 (no is good)                                                           |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| P6_LINE_4              | yes/no                                      | removed, neither yes or no is not good nor bad                             |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| P6_Line_5              | yes/no                                      | 0/1 (no is good)                                                           |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| P6_LINE_7A             | yes/no                                      | 0/1 (no is good)                                                           |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| P6_Line_7B             | yes/no                                      | 0/1 (no is good)                                                           |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| P6_LINE_10A            | yes/no                                      | 1 - (10A no) or (10A yes + 10B yes)                                        |
|                        |                                             |                                                                            |
| P6_LINE_10B            | yes/no/NA                                   | 0 - (10A yes + 10B no)                                                     |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| P6_LINE_12B            | yes/no/NA                                   | 1 - (12A yes + 12B yes) or (12A no)                                        |
|                        |                                             |                                                                            |
|                        |                                             | 0 - (12 A yes + 12B no)                                                    |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| P6_LINE_12C            | yes/no/NA                                   | 1 - (12A yes + 12C yes) or (12A no)                                        |
|                        |                                             |                                                                            |
|                        |                                             | 0 - (12 A yes + 12C no)                                                    |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| P6_LINE_16A            | yes/no                                      | 1 - (16A no) or (16A yes + 16B yes)                                        |
|                        |                                             |                                                                            |
| P6_LINE_16B            | yes/no/NA                                   | 0 - (16A yes + 16B no)                                                     |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| P6_LINE_18             | request/own website/another's website/other | 1 - own website                                                            |
|                        |                                             |                                                                            |
|                        |                                             | 0 - anything else                                                          |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| All other P6\_\*       | yes/no                                      | 1/0                                                                        |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| P12_LINE_1             | Accrual/cash                                | 1 - Accrual                                                                |
|                        |                                             |                                                                            |
|                        |                                             | 0 - anything else                                                          |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| P12_LINE_2A            | both/consol/no/seperate                     | 0 - no                                                                     |
|                        |                                             |                                                                            |
|                        |                                             | 1 - anything else                                                          |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| P12_LINE_2B            | both/consol/no/seperate                     | 0 - no                                                                     |
|                        |                                             |                                                                            |
|                        |                                             | 1 - anything else                                                          |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| P12_LINE_2C            | yes/no/NA                                   | 1 -( 2B yes + 2C yes ) or (2A yes + 2C yes) or (2a no ) or (2b no)         |
|                        |                                             |                                                                            |
|                        |                                             | 0- (2a yes and 2c no) or (2b yes and 2c no)                                |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+
| P12_LINE_3A/           | yes/no                                      | 1 - (3a no) + (3a yes +3b yes)                                             |
|                        |                                             |                                                                            |
| P12_LINE_3B            | yes/no                                      | 0 - (3a yes + 3b no)                                                       |
+------------------------+---------------------------------------------+----------------------------------------------------------------------------+

```{r}
#For P6_LINE_1B / P6_LINE_1A >= 0.75
indep_members_threshold <- 0.75


design_mat <- 
  dat_govern %>% 
  #dont need P6_SCHEDULE_O, P12_LINE_1_OTHER_EXPLAIN, RETURN TYPE
  select(- c(P6_SCHEDULE_O, P12_LINE_1_OTHER_EXPLAIN, RETURN_TYPE, P6_LINE_4)) %>%
  #remove all is.na in all columns except P6_LINE_10B, P6_LINE_12B, P6_LINE_12C, P6_LINE_16B, PM_LINE_31
  filter(if_all(-c(P6_LINE_10B, P6_LINE_12B, P6_LINE_12C, P6_LINE_16B, P6_LINE_18, PM_LINE_31), 
                ~ !is.na(.))) %>%
  #P4 Line 12
  mutate(P4_LINE_12 = ifelse(P4_LINE_12A == "yes" | P4_LINE_12B == "yes", 1, 0)) %>%
  select(-c(P4_LINE_12A, P4_LINE_12B))%>%
  #P4 line 28
  mutate(P4_LINE_28 = ifelse(
    P4_LINE_28A == "yes" | 
    P4_LINE_28B == "yes" |
    P4_LINE_28C == "yes" , 0, 1)) %>%
  select(-c(P4_LINE_28A, P4_LINE_28B, P4_LINE_28C)) %>% 
  #P4 line 29 and 30, Schedule M
  mutate(P4_LINE_29_30 = case_when(
         P4_LINE_29 == "yes" & PM_LINE_31 == "no" ~ 0,
         P4_LINE_30 == "yes" & PM_LINE_31 == "no" ~ 0,
         TRUE ~ 1)) %>% 
  select(-c(P4_LINE_29, P4_LINE_30, PM_LINE_31)) %>% 
  #P6_LINE_1 
  filter(P6_LINE_1A != 0) %>% # remove divide by 0 errors
  filter(P6_LINE_1A < P6_LINE_1B) %>% # remove cases where more independent members than members
  mutate(P6_LINE_1 = ifelse(P6_LINE_1B / P6_LINE_1A >= indep_members_threshold, 1, 0)) %>% 
  select(-c(P6_LINE_1B , P6_LINE_1A )) %>%
  #P6_LINE_2, 5, 7A, 7B
  mutate_at(vars("P6_LINE_2", "P6_LINE_3", "P6_LINE_5", "P6_LINE_7A", "P6_LINE_7B") ,
         ~ ifelse(. == "no", 1, 0)) %>%
  #P6_Line_10
  mutate(P6_LINE_10 = case_when(
    P6_LINE_10A == "no"  ~ 1,
    P6_LINE_10A == "yes" & P6_LINE_10B == "yes" ~ 1,
    P6_LINE_10A == "yes" & P6_LINE_10B == "no"  ~ 0
  )) %>% 
  select(-c(P6_LINE_10A, P6_LINE_10B)) %>% 
  #P6_LINE_12B
  mutate(P6_LINE_12B = case_when(
    P6_LINE_12A == "no"  ~ 1,
    P6_LINE_12A == "yes" & P6_LINE_12B == "yes" ~ 1,
    P6_LINE_12A == "yes" & P6_LINE_12B == "no"  ~ 0
  )) %>% 
  #P6_LINE_12C
  mutate(P6_LINE_12C = case_when(
    P6_LINE_12A == "no"  ~ 1,
    P6_LINE_12A == "yes" & P6_LINE_12C == "yes" ~ 1,
    P6_LINE_12A == "yes" & P6_LINE_12C == "no"  ~ 0
  )) %>% 
  #P6_LINE_16
  mutate(P6_LINE_16 = case_when(
    P6_LINE_16A == "no"  ~ 1,
    P6_LINE_16A == "yes" & P6_LINE_16B == "yes" ~ 1,
    P6_LINE_16A == "yes" & P6_LINE_16B == "no"  ~ 0
  )) %>% 
  select(-c(P6_LINE_16A, P6_LINE_16B)) %>% 
  # P6_LINE_18 
  mutate(P6_LINE_18 = case_when(
    P6_LINE_18 == "own_website" ~ 1 , 
    is.na(P6_LINE_18) ~ 0,
    TRUE ~ 0
  )) %>% 
  # All other P6
  mutate_at(vars( paste0("P6_LINE_", c( 6, "8A", "8B", "11A", "12A", 13, 14, "15A", "15B"))),
           ~  ifelse(. == "yes", 1, 0)) %>% 
  # P12_LINE_1 
  mutate(P12_LINE_1 = ifelse(P12_LINE_1 == "accrual", 1, 0)) %>% 
  # P12_Line_2A
  mutate(P12_LINE_2A = ifelse(P12_LINE_2A == "no", 0, 1)) %>% 
  # P12_Line_2B
  mutate(P12_LINE_2B = ifelse(P12_LINE_2B == "no", 0, 1)) %>%
  #P12_Line_2C
  mutate(P12_LINE_2C = case_when(
    P12_LINE_2A == "no" ~ 1,
    P12_LINE_2B == "no" ~ 1,
    P12_LINE_2A == "yes" & P12_LINE_2C == "yes" ~ 1,
    P12_LINE_2B == "yes" & P12_LINE_2C == "yes" ~ 1,
    P12_LINE_2A == "yes" & P12_LINE_2C == "no" ~ 0,
    P12_LINE_2B == "yes" & P12_LINE_2C == "no" ~ 0,
    TRUE ~ 0
  )) %>%
  #P12_Line_3
  mutate(P12_LINE_3 = case_when(
    P12_LINE_3A == "no" ~ 1,
    P12_LINE_3A == "yes" & P12_LINE_3B == "yes" ~ 1,
    P12_LINE_3A == "yes" & P12_LINE_3B == "no" ~ 0,
    TRUE ~ 0
  )) %>% 
  select(-c(P12_LINE_3A, P12_LINE_3B)) 
  

# nothing is NA
dim(design_mat)
dim(na.omit(design_mat))


#store ID's to remove from data set 
design_mat_ID <- design_mat[, 1:5]
design_mat <- design_mat[, -(1:5)]

     
```

## EDA

## Basic Summary Tables

```{r}
tab_list <- design_mat %>%
  map( function(x) as.data.frame(table(x) ))

tab_summary <-
  rbindlist(tab_list,
          idcol = TRUE,
          fill = TRUE) %>% 
  as.data.frame() %>% 
  mutate(x = paste0("num", x)) %>%
  pivot_wider(names_from = "x", values_from = "Freq") %>%
  mutate(perc0 = round(num0 / (num0 + num1), 3), 
         perc1 = round(num1 / (num0 + num1), 3))%>% 
  arrange(.id)

tab_summary%>%
  kable() %>% 
  kable_styling()


### Remove varaibles where less than 2% in either class 
### This was as small as I could make it without the correlation matrix being singular
### Remove 2B because it is perfectly correlated with 2A
perc_threshold <- 0.02

vars_keep <- 
  tab_summary %>% 
  filter(perc0 > perc_threshold & perc1 > perc_threshold) %>% 
  filter(.id != "P12_LINE_2B") %>%
  pull(.id)

```

### Correlation Matrix

```{r}
library(polycor)
library(ggcorrplot)


# make as factor
design_mat_keep <- sapply(design_mat[, ..vars_keep], as.factor) #note the ..vars_keep. the ".." is deliberalty needed in datatable package updates 


corr_mat <- hetcor(design_mat_keep, ML = TRUE) #usues maximum likelihood estimates

ggcorrplot(corr_mat$correlations,
           hc.order = TRUE ) +
  ggtitle("Correlation Matrix") +
  labs(subtitle = "Variables with More than 2% is either class")
```

## Factor Analysis

### 2 factors

```{r}
library(psych)
### EFA using minimum residual
faPC2 <- fa(r=corr_mat$correlations, 
           nfactors=2, 
           n.obs=nrow(design_mat), 
           rotate="varimax")

# Tucker-Lewis Index (TLI). An acceptable value must be greater over 0.9.
faPC2$TLI

#root mean square of residuals (RMSR). An acceptable value should be closer to 0. 
faPC2$rms

#loadings
faPC2$loadings


```

Only 43% of the variance is explained. Let's add another dimension.

### 3 Factors

```{r}
### EFA using minimum residual
faPC3 <- fa(r=corr_mat$correlations, 
           nfactors=3, 
           n.obs=nrow(design_mat), 
           rotate="varimax")

# Tucker-Lewis Index (TLI). An acceptable value must be greater over 0.9.
faPC3$TLI

#root mean square of residuals (RMSR). An acceptable value should be closer to 0. 
faPC3$rms

#loadings
faPC3$loadings


```

Ultra haywood case : "An ultra-Heywood case implies that some unique factor has negative variance... Possible causes include the following:

-   bad prior communality estimates

-   too many common factors

-   too few common factors

-   not enough data to provide stable estimates

-   the common factor model is not an appropriate model for the data"

<https://documentation.sas.com/doc/en/pgmsascdc/9.4_3.4/statug/statug_factor_details10.htm>

Let's try to remove some of the near perfect correlations and see what happens:

```{r}
dat_cor <- as.data.frame(corr_mat$correlations)
dat_cor$var1 <- rownames(dat_cor) 

dat_cor%>% 
  pivot_longer(!var1, names_to = "var2", values_to = "cor") %>% 
  filter(var1 != var2) %>%
  arrange(desc(abs(cor))) %>%
  filter(abs(cor) >= 0.90)


```

-   P6_Line_13 = have whistleblower policy?

-   P6_Line_14 = have document retention and destruction policy?

-   P6_LINE_15A = compensation review and approval for CEO?

-   P6_LINE_15B = compensation review and approval for other officers and key employees?

-   P6_LINE_12B = Were officers, directors, or trustees, and key employees required to disclose annually interests that could give rise to conflicts?

-   P6_LINE_12C = Did the organization regularly and consistently monitor and enforce compliance with the policy?

-   P6_LINE_6 = Did the organization have members or stockholders?

-   P6_Line_7A = Did the organization have members, stockholders, or other persons who had the power to elect one or more members of the governing body?

Let's remove P6_Line_14, P6_LINE_15B, P6_LINE_12C, P6_LINE_6 and see if that helps.

```{r}
remove_cols <- colnames(design_mat_keep) %in%c("P6_LINE_14","P6_LINE_15B", "P6_LINE_12C","P6_LINE_6", "P6_LINE_8B", "P6_LINE_7B")


design_mat_keep2 <- design_mat_keep[ ,!remove_cols]


corr_mat2 <- hetcor(design_mat_keep2, ML = TRUE) #usues maximum likelihood estimates

ggcorrplot(corr_mat2$correlations,
           hc.order = TRUE ) +
  ggtitle("Correlation Matrix") +
  labs(subtitle = "Variables with More than 2% is either class")

```

```{r}
### EFA using minimum resigudal
faPC3 <- fa(r=corr_mat2$correlations, 
           nfactors=3, 
           n.obs=nrow(design_mat),
           scores = "Bartlett")

# Tucker-Lewis Index (TLI). An acceptable value must be greater over 0.9.
faPC3$TLI

#root mean square of residuals (RMSR). An acceptable value should be closer to 0. 
faPC3$rms

#loadings
faPC3$loadings


```

### Trying factor analysis again

```{r}

features2 <-  matrix( 
  as.numeric(design_mat_keep), ncol = ncol(design_mat_keep)) 

colnames(features2) <- colnames(design_mat_keep)

#remove 12B for some reason
features2 <- features2[-6, -6]

## Pearson Correlation
pear_cor2 = cor(features2)
cor.plot(pear_cor2, numbers=T, upper=FALSE, main = "Pearson Correlation", show.legend = FALSE)

## Polychoric correlation
poly_cor2 = polychoric(features2)
rho2 = poly_cor2$rho

### Thresholds/Scaling results
#poly_cor2$tau
cor.plot(poly_cor2$rho, numbers=T, upper=FALSE, main = "Polychoric Correlation", show.legend = FALSE)



### Plot the difference
diff2 = (poly_cor2$rho - pear_cor2)*((pear_cor2>=0)*2-1)
cor.plot(diff2, numbers=T, upper=FALSE, diag=FALSE)
#quite a differnce in some places, we will stick with the poly corrs





```

There is quite a difference between Pearson and Polychoric correlation. Let's stick with the polychoric correlation.

```{r}

# Scree plot to find number of dimensions
fa.parallel(rho2, fm="pa", fa="fa", main = "Scree Plot",
            n.obs = nrow(design_mat_keep))

## things strart to level off at 5. Let's try 4 to start

poly_model2 = fa(features2, nfactor=4, cor="poly", fm="mle", rotate = "none")
poly_model2$loadings
fa.diagram(poly_model2)


```

### Removing things that make it non-positive definite

Let's try to eliminate some of the near perfect correlations and see what happens. I think it will eliminate the non-positive definite stuff:

```{r}
dat_cor <- as.data.frame(corr_mat$correlations)
dat_cor$var1 <- rownames(dat_cor) 

dat_cor%>% 
  pivot_longer(!var1, names_to = "var2", values_to = "cor") %>% 
  filter(var1 != var2) %>%
  arrange(desc(abs(cor))) %>%
  filter(abs(cor) >= 0.90)


```

-   P6_Line_13 = have whistleblower policy?

-   P6_Line_14 = have document retention and destruction policy?

-   P6_LINE_15A = compensation review and approval for CEO?

-   P6_LINE_15B = compensation review and approval for other officers and key employees?

-   P6_LINE_12B = Were officers, directors, or trustees, and key employees required to disclose annually interests that could give rise to conflicts?

-   P6_LINE_12C = Did the organization regularly and consistently monitor and enforce compliance with the policy?

-   P6_LINE_6 = Did the organization have members or stockholders?

-   P6_Line_7A = Did the organization have members, stockholders, or other persons who had the power to elect one or more members of the governing body?

Let's remove P6_Line_14, P6_LINE_15B, P6_LINE_12C, P6_LINE_6 and see if that helps.

```{r}
remove_cols <- colnames(design_mat_keep) %in%c("P6_LINE_14","P6_LINE_15B", "P6_LINE_12C","P6_LINE_6", "P6_LINE_8B", "P6_LINE_7B")


design_mat_keep2 <- design_mat_keep[ ,!remove_cols]

```

### Trying factor analysis again

```{r}

features2 <-  matrix( 
  as.numeric(design_mat_keep2), ncol = ncol(design_mat_keep2)) 

colnames(features2) <- colnames(design_mat_keep2)

#remove 12B for some reason
features2 <- features2[-6, -6]

## Pearson Correlation
pear_cor2 = cor(features2)
cor.plot(pear_cor2, numbers=T, upper=FALSE, main = "Pearson Correlation", show.legend = FALSE)

## Polychoric correlation
poly_cor2 = polychoric(features2)
rho2 = poly_cor2$rho

### Thresholds/Scaling results
#poly_cor2$tau
cor.plot(poly_cor2$rho, numbers=T, upper=FALSE, main = "Polychoric Correlation", show.legend = FALSE)



### Plot the difference
diff2 = (poly_cor2$rho - pear_cor2)*((pear_cor2>=0)*2-1)
cor.plot(diff2, numbers=T, upper=FALSE, diag=FALSE)
#quite a differnce in some places, we will stick with the poly corrs





```

Again, there is quite a difference between Pearson and Polychoric correlation. Let's stick with the polychoric correlation.

```{r}

# Scree plot to find number of dimensions
fa.parallel(rho2, fm="pa", fa="fa", main = "Scree Plot",
            n.obs = nrow(design_mat_keep2))

#stick with 4 to be consistant
poly_model2 = fa(features2, nfactor=4, cor="poly", fm="mle", rotate = "none")
poly_model2$loadings
fa.diagram(poly_model2)


```

This looks pretty good! Let's see if the groups mean anything.

+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+
| Items                                                                                                                                                                                                                                               | Potential Group Names                                                                |
+=====================================================================================================================================================================================================================================================+======================================================================================+
| -   P6_Line_12A : Whether have a written conflict of interest policy                                                                                                                                                                                | -   Open/transparent accounting practices                                            |
| -   P6_Line_13: Whether have a written whistleblower policy                                                                                                                                                                                         |                                                                                      |
| -   P6_Line_15A : Whether have a process for determining compensation of the CEO, executive director, or top management officials include a review and approval by independent persons, comparability data, and deliberation decision               | -                                                                                    |
| -   P4_Line_12: Does the organization obtain separate, independent audited finanical statements                                                                                                                                                     |                                                                                      |
| -   P6_Line_11A: Whether provided a copy of Form 990 to all members before filing the form                                                                                                                                                          |                                                                                      |
| -   P6_Line_18: Are your forms available to the public?                                                                                                                                                                                             |                                                                                      |
| -   (Negative): P4_Line_29/30: Did the organization receive more than \$25,000 in noncash contributions? Did the organization receive contributions of art, historical treasures, or other similar assets, or qualified conservation contributions? |                                                                                      |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+
| -   P6_Line_7A: Did the organization have members, stockholders, or other persons who had the power to elect.                                                                                                                                       | -   Delegating management duties to others one or more members of the governing body |
|                                                                                                                                                                                                                                                     |                                                                                      |
| -   P6_Line_3: Did the organization delegate control over management duties customarily performed by or under the direct supervision of officers, directors, trustees, or key employees to a management company or other person?                    |                                                                                      |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+
| -   P6_Line_3: Did the organization delegate control over management duties customarily performed by or under the direct supervision of officers, directors, trustees, or key employees to a management company or other person?                    |                                                                                      |
|                                                                                                                                                                                                                                                     |                                                                                      |
| -   P6_Line_8A: Did the organization contemporaneously document the meetings held or written actions undertaken during the year by the following?                                                                                                   |                                                                                      |
|                                                                                                                                                                                                                                                     |                                                                                      |
| -   (Negative) P6_Line_7A: Did the organization have members, stockholders, or other persons who had the power to elect one or more members of the governing body                                                                                   |                                                                                      |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+
| -   P12_Line_1: Accounting method used to prepare the Form 990: Accrual or other                                                                                                                                                                    | -   Best accounting methods                                                          |
|                                                                                                                                                                                                                                                     |                                                                                      |
| -   P4_Line_12: Did the organization obtain separate, independent audited financial statements for the tax year?                                                                                                                                    |                                                                                      |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+

## PCA with 4 factors

```{r}
pca.out <- principal(rho2, nfactors = 4, rotate = "oblimin")

fa.diagram(pca.out) 

```

Let's explore the groupings to see if they have meaning:

+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------+
| Items                                                                                                                                                                                                                                               | Themes                                                                 |
+=====================================================================================================================================================================================================================================================+========================================================================+
| -   P6_Line_13: Whether have a written whistleblower policy                                                                                                                                                                                         | -   Being open and transparent about hiring practices for key personal |
|                                                                                                                                                                                                                                                     |                                                                        |
| -   P6_Line_11A: Whether provided a copy of Form 990 to all members before filing the form                                                                                                                                                          | -                                                                      |
|                                                                                                                                                                                                                                                     |                                                                        |
| -   P6_Line_15A : Whether have a process for determining compensation of the CEO, executive director, or top management officials include a review and approval by independent persons, comparability data, and deliberation decision               |                                                                        |
|                                                                                                                                                                                                                                                     |                                                                        |
| -   (Negative) P6_Line_2: Did any officer, director, trustee, or key employee have a family relationship or a business relationship with any other officer, director, trustee, or key employee?                                                     |                                                                        |
|                                                                                                                                                                                                                                                     |                                                                        |
| -   (Negative) P4_Line_29/30: Did the organization receive more than \$25,000 in noncash contributions? Did the organization receive contributions of art, historical treasures, or other similar assets, or qualified conservation contributions?  |                                                                        |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------+
| -    P12_Line1: Accounting method used to prepare the Form 990 in any of the following forms: accrual or other                                                                                                                                      | Best accounting practices                                              |
|                                                                                                                                                                                                                                                     |                                                                        |
| -    P4_Line_12: Whether obtained separate, independent audited financial statements                                                                                                                                                                |                                                                        |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------+
| -    (Negative) P6_Line_7A: Whether have any persons who had power to elect or appoint members (y/n)                                                                                                                                                | something about good governing practices                               |
|                                                                                                                                                                                                                                                     |                                                                        |
| -   P6_Line_8A: Whether documented the meetings by the governing body                                                                                                                                                                               |                                                                        |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------+
| -   P6_Line_3: Whether used a management company or other person to perform any management duties                                                                                                                                                   | -   Open accounting practices                                          |
|                                                                                                                                                                                                                                                     |                                                                        |
| -   P6_Line_18: Do you have your IRS forms published publicly                                                                                                                                                                                       |                                                                        |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------+

Looks good!
